df_2way = df
summary = apply(df[,c(1,2,3,4,7,8)], MARGIN = 2, quantile , probs = c(0, 0.25, 0.5, 0.75, 1))
rownames(summary) <- c('Min.', '1st Qu.', 'Median', '3rd Qu.', 'Max.')
xtable(summary, caption = 'Distribution of relative MSE for different imputation methods for data with 30% values MCAR (Bivariate probabilities)', digits = 2)
setEPS()
postscript("../figures/rmse_12way_MCAR_30.eps", width=10, height=6, horizontal = FALSE, onefile=FALSE)
par(mfrow=c(1,2), oma = c(5.5,4.5,0.2,0.2) + 0.1, mar = c(0.75,0.25,1.25,1.25) + 0.1)
boxplot(df_1way[, c(1,2,3,4,7,8)], col = 'light blue', ylim = c(0,5), main = paste('Marginal'),
las = 2)
boxplot(df_2way[,c(1,2,3,4,7,8)], col = 'peachpuff', ylim = c(0,5), main = paste('Bivariate'),
las = 2, yaxt="n")
axis(2, labels=FALSE)
title(ylab = "Relative MSE (fraction)",
outer = TRUE, line = 3)
dev.off()
n_way = 3
rel_MSE = rel_MSE_models(data_name, n_way)
df = format_list(rel_MSE)
summary = apply(df, MARGIN = 2, quantile , probs = c(0, 0.25, 0.5, 0.75, 1))
rownames(summary) <- c('Min.', '1st Qu.', 'Median', '3rd Qu.', 'Max.')
xtable(summary, caption = 'Distribution of relative MSE for different imputation methods for data with 30% values MCAR (Trivariate probabilities)', digits = 2)
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'h', fig.align = 'center')
knitr::opts_chunk$set(fig.cap = "",  fig.path = "Plot")
library(knitr)
library(dplyr)
library(readr)
library(xtable)
source("../../utils/compute_rel_MSE.R")
data_name = 'MCAR_45'
n_imputations = 50
n_way = 1
rel_MSE = rel_MSE_models(data_name, n_way)
df = format_list(rel_MSE)
df_1way = df
summary = apply(df[,c(1,2,3,4,7,8)], MARGIN = 2, quantile , probs = c(0, 0.25, 0.5, 0.75, 1))
rownames(summary) <- c('Min.', '1st Qu.', 'Median', '3rd Qu.', 'Max.')
xtable(summary, caption = 'Distribution of relative MSE for different imputation methods for data with 45% values MCAR (Marginal probabilities)', digits = 2)
boxplot(df, col = 'light blue', xlab = 'Imputation method',
ylab = 'Relative MSE (fraction)', ylim = c(0,500),
main = paste('Relative MSE from different imputation methods: Marginal pmf'))
n_way = 2
rel_MSE = rel_MSE_models(data_name, n_way)
df = format_list(rel_MSE)
df_2way = df
summary = apply(df[,c(1,2,3,4,7,8)], MARGIN = 2, quantile , probs = c(0, 0.25, 0.5, 0.75, 1))
rownames(summary) <- c('Min.', '1st Qu.', 'Median', '3rd Qu.', 'Max.')
xtable(summary, caption = 'Distribution of relative MSE for different imputation methods for data with 45% values MCAR (Bivariate probabilities)', digits = 2)
setEPS()
postscript("../figures/rmse_12way_MCAR_45.eps", width=10, height=6, horizontal = FALSE, onefile=FALSE)
par(mfrow=c(1,2), oma = c(5.5,4.5,0.2,0.2) + 0.1, mar = c(0.75,0.25,1.25,1.25) + 0.1)
boxplot(df_1way[, c(1,2,3,4,7,8)], col = 'light blue', ylim = c(0,10), main = paste('Marginal'),
las = 2)
boxplot(df_2way[,c(1,2,3,4,7,8)], col = 'peachpuff', ylim = c(0,10), main = paste('Bivariate'),
las = 2, yaxt="n")
axis(2, labels=FALSE)
title(ylab = "Relative MSE (fraction)",
outer = TRUE, line = 3)
dev.off()
n_way = 3
rel_MSE = rel_MSE_models(data_name, n_way)
df = format_list(rel_MSE)
summary = apply(df, MARGIN = 2, quantile , probs = c(0, 0.25, 0.5, 0.75, 1))
rownames(summary) <- c('Min.', '1st Qu.', 'Median', '3rd Qu.', 'Max.')
xtable(summary, caption = 'Distribution of relative MSE for different imputation methods for data with 45% values MCAR (Trivariate probabilities)', digits = 2)
GLR <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")[[1]]
dim(GLR)
GLR <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
View(GLR)
View(GLR)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
mean(denominator)
mean(numerator)
denominator[1]
denom_dof = 2*(10880-222)-1 # N-t N - size of sample, t - dimension of clutter space
num_dof = 2*1 #dimension of the target space
0.02386263/(1.319091e-05)
View(numerator)
View(denominator)
mean(numerator/denominator)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
mean(numerator)
mean(denominator)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
print('mean numerator')
mean(numerator)
print('mean denominator')
mean(denominator)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
print('mean numerator')
mean(numerator)
print('mean denominator')
mean(denominator)
num_dof = 2*1 #dimension of the target space
denom_dof = 2*(10880-222) # N-t N - size of sample, t - dimension of clutter space
# attempt to scale back y
numerator = numerator*2/mean(numerator)
numerator = numerator*2/mean(numerator) # attempt to scale back y
x_2_sample = rchisq(10000,df=num_dof)
ks.test(x = numerator, y = ecdf(x_2_sample))
qqplot(numerator, x_2_sample, ylab = 'X^2(dof = 2)', xlab = 'nuemrator')
mean(numerator)
mean(x_2_sample)
# DO NOT ALTER CODE IN THIS CHUNK
# The very first time you use this R markdown file, you should install each of the packages below.
# The same goes for other packages you might decide to use
# Remember that you only need to install each R package once in R (ever -- unless you change computers).
# All you need to do whenever you need to use the package again (after restarting the R session),
# is to use the library function to call the package.
# For example, type install.packages("knitr") in the console to install the knitr package.
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'h', fig.align = 'center')
knitr::opts_chunk$set(fig.cap = "",  fig.path = "Plot")
library(knitr)
library(dplyr)
library(arm)
library(pROC)
library(tidyverse)
library(MASS)
library(tigerstats)
library(leaps)
library(car)
library(rms)
require(caret)
require(e1071)
library(lme4)
library(lattice)
library(broom)
library(boot)
library(ggplot2)
library(cobalt)
require(tidyverse)
require(rstanarm)
require(magrittr)
require(rstan)
require(MCMCpack)
library(abind)
library(matrixStats)
library(truncnorm)
library(mvtnorm)
library(MCMCpack)
library(mnormt)
library(coda)
library(R.matlab)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
print('mean numerator')
mean(numerator)
print('mean denominator')
mean(denominator)
num_dof = 2*1 #dimension of the target space
denom_dof = 2*(10880-222) # N-t N - size of sample, t - dimension of clutter space
numerator = numerator*2/mean(numerator) # attempt to scale back y
x_2_sample = rchisq(10000,df=num_dof)
ks.test(x = numerator, y = ecdf(x_2_sample))
qqplot(numerator, x_2_sample, ylab = 'X^2(dof = 2)', xlab = 'numerator')
# DO NOT ALTER CODE IN THIS CHUNK
# The very first time you use this R markdown file, you should install each of the packages below.
# The same goes for other packages you might decide to use
# Remember that you only need to install each R package once in R (ever -- unless you change computers).
# All you need to do whenever you need to use the package again (after restarting the R session),
# is to use the library function to call the package.
# For example, type install.packages("knitr") in the console to install the knitr package.
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'h', fig.align = 'center')
knitr::opts_chunk$set(fig.cap = "",  fig.path = "Plot")
library(knitr)
library(dplyr)
library(arm)
library(pROC)
library(tidyverse)
library(MASS)
library(tigerstats)
library(leaps)
library(car)
library(rms)
require(caret)
require(e1071)
library(lme4)
library(lattice)
library(broom)
library(boot)
library(ggplot2)
library(cobalt)
require(tidyverse)
require(rstanarm)
require(magrittr)
require(rstan)
require(MCMCpack)
library(abind)
library(matrixStats)
library(truncnorm)
library(mvtnorm)
library(MCMCpack)
library(mnormt)
library(coda)
library(R.matlab)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
print('mean numerator')
mean(numerator)
print('mean denominator')
mean(denominator)
num_dof = 1 #dimension of the target space
denom_dof = 2*(18144-240) # N-t N - size of sample, t - dimension of clutter space
numerator = numerator*2/mean(numerator) # attempt to scale back y
x_2_sample = rchisq(10000,df=num_dof)
ks.test(x = numerator, y = ecdf(x_2_sample))
qqplot(numerator, x_2_sample, ylab = 'X^2(dof = 2)', xlab = 'numerator')
mean(numerator)
# DO NOT ALTER CODE IN THIS CHUNK
# The very first time you use this R markdown file, you should install each of the packages below.
# The same goes for other packages you might decide to use
# Remember that you only need to install each R package once in R (ever -- unless you change computers).
# All you need to do whenever you need to use the package again (after restarting the R session),
# is to use the library function to call the package.
# For example, type install.packages("knitr") in the console to install the knitr package.
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'h', fig.align = 'center')
knitr::opts_chunk$set(fig.cap = "",  fig.path = "Plot")
library(knitr)
library(dplyr)
library(arm)
library(pROC)
library(tidyverse)
library(MASS)
library(tigerstats)
library(leaps)
library(car)
library(rms)
require(caret)
require(e1071)
library(lme4)
library(lattice)
library(broom)
library(boot)
library(ggplot2)
library(cobalt)
require(tidyverse)
require(rstanarm)
require(magrittr)
require(rstan)
require(MCMCpack)
library(abind)
library(matrixStats)
library(truncnorm)
library(mvtnorm)
library(MCMCpack)
library(mnormt)
library(coda)
library(R.matlab)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
print('mean numerator')
mean(numerator)
print('mean denominator')
mean(denominator)
num_dof = 1 #dimension of the target space
denom_dof = 2*(18144-240) # N-t N - size of sample, t - dimension of clutter space
numerator = numerator*num_dof/mean(numerator) # attempt to scale back y
x_2_sample = rchisq(10000,df=num_dof)
ks.test(x = numerator, y = ecdf(x_2_sample))
qqplot(numerator, x_2_sample, ylab = 'X^2(dof = 2)', xlab = 'numerator')
# DO NOT ALTER CODE IN THIS CHUNK
# The very first time you use this R markdown file, you should install each of the packages below.
# The same goes for other packages you might decide to use
# Remember that you only need to install each R package once in R (ever -- unless you change computers).
# All you need to do whenever you need to use the package again (after restarting the R session),
# is to use the library function to call the package.
# For example, type install.packages("knitr") in the console to install the knitr package.
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'h', fig.align = 'center')
knitr::opts_chunk$set(fig.cap = "",  fig.path = "Plot")
library(knitr)
library(dplyr)
library(arm)
library(pROC)
library(tidyverse)
library(MASS)
library(tigerstats)
library(leaps)
library(car)
library(rms)
require(caret)
require(e1071)
library(lme4)
library(lattice)
library(broom)
library(boot)
library(ggplot2)
library(cobalt)
require(tidyverse)
require(rstanarm)
require(magrittr)
require(rstan)
require(MCMCpack)
library(abind)
library(matrixStats)
library(truncnorm)
library(mvtnorm)
library(MCMCpack)
library(mnormt)
library(coda)
library(R.matlab)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
print('mean numerator')
mean(numerator)
print('mean denominator')
mean(denominator)
num_dof = 2*1 #dimension of the target space
denom_dof = 2*(18144-240) # N-t N - size of sample, t - dimension of clutter space
numerator = numerator*num_dof/mean(numerator) # attempt to scale back y
x_2_sample = rchisq(10000,df=num_dof)
ks.test(x = numerator, y = ecdf(x_2_sample))
qqplot(numerator, x_2_sample, ylab = 'X^2(dof = 2)', xlab = 'numerator')
mean(numerator)
?rchisq
qqplot(numerator[numerator<20], x_2_sample, ylab = 'X^2(dof = 2)', xlab = 'numerator')
qqplot(numerator, x_2_sample, ylab = 'X^2(dof = 2)', xlab = 'numerator')
# DO NOT ALTER CODE IN THIS CHUNK
# The very first time you use this R markdown file, you should install each of the packages below.
# The same goes for other packages you might decide to use
# Remember that you only need to install each R package once in R (ever -- unless you change computers).
# All you need to do whenever you need to use the package again (after restarting the R session),
# is to use the library function to call the package.
# For example, type install.packages("knitr") in the console to install the knitr package.
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'h', fig.align = 'center')
knitr::opts_chunk$set(fig.cap = "",  fig.path = "Plot")
library(knitr)
library(dplyr)
library(arm)
library(pROC)
library(tidyverse)
library(MASS)
library(tigerstats)
library(leaps)
library(car)
library(rms)
require(caret)
require(e1071)
library(lme4)
library(lattice)
library(broom)
library(boot)
library(ggplot2)
library(cobalt)
require(tidyverse)
require(rstanarm)
require(magrittr)
require(rstan)
require(MCMCpack)
library(abind)
library(matrixStats)
library(truncnorm)
library(mvtnorm)
library(MCMCpack)
library(mnormt)
library(coda)
library(R.matlab)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
print('mean numerator')
mean(numerator)
print('mean denominator')
mean(denominator)
num_dof = 2*1 #dimension of the target space
denom_dof = 2*(18144-240) # N-t N - size of sample, t - dimension of clutter space
numerator = numerator*num_dof/mean(numerator) # attempt to scale back y
x_2_sample = rchisq(10000,df=num_dof)
ks.test(x = numerator, y = ecdf(x_2_sample))
qqplot(numerator, x_2_sample, ylab = 'X^2(dof = 2)', xlab = 'numerator')
# DO NOT ALTER CODE IN THIS CHUNK
# The very first time you use this R markdown file, you should install each of the packages below.
# The same goes for other packages you might decide to use
# Remember that you only need to install each R package once in R (ever -- unless you change computers).
# All you need to do whenever you need to use the package again (after restarting the R session),
# is to use the library function to call the package.
# For example, type install.packages("knitr") in the console to install the knitr package.
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'h', fig.align = 'center')
knitr::opts_chunk$set(fig.cap = "",  fig.path = "Plot")
library(knitr)
library(dplyr)
library(arm)
library(pROC)
library(tidyverse)
library(MASS)
library(tigerstats)
library(leaps)
library(car)
library(rms)
require(caret)
require(e1071)
library(lme4)
library(lattice)
library(broom)
library(boot)
library(ggplot2)
library(cobalt)
require(tidyverse)
require(rstanarm)
require(magrittr)
require(rstan)
require(MCMCpack)
library(abind)
library(matrixStats)
library(truncnorm)
library(mvtnorm)
library(MCMCpack)
library(mnormt)
library(coda)
library(R.matlab)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
print('mean numerator')
mean(numerator)
print('mean denominator')
mean(denominator)
num_dof = 2*1 #dimension of the target space
denom_dof = 2*(18144-240) # N-t N - size of sample, t - dimension of clutter space
numerator = numerator*num_dof/mean(numerator) # attempt to scale back y
x_2_sample = rchisq(10000,df=num_dof)
ks.test(x = numerator, y = ecdf(x_2_sample))
print(mean(numerator))
print(mean(x_2_sample))
qqplot(numerator, x_2_sample, ylab = 'X^2(dof = 2)', xlab = 'numerator')
denominator = denominator*denom_dof/mean(denominator) # attempt to scale back y
x_2_sample = rchisq(10000,df=denom_dof)
ks.test(x = denominator, y = ecdf(x_2_sample))
print(mean(denominator))
print(mean(x_2_sample))
qqplot(denominator, x_2_sample, ylab = 'X^2(dof = 2*(N-t))', xlab = 'denominator')
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
print('mean numerator')
mean(numerator)
print('mean denominator')
mean(denominator)
0.02386263/1.319091e-05
# DO NOT ALTER CODE IN THIS CHUNK
# The very first time you use this R markdown file, you should install each of the packages below.
# The same goes for other packages you might decide to use
# Remember that you only need to install each R package once in R (ever -- unless you change computers).
# All you need to do whenever you need to use the package again (after restarting the R session),
# is to use the library function to call the package.
# For example, type install.packages("knitr") in the console to install the knitr package.
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'h', fig.align = 'center')
knitr::opts_chunk$set(fig.cap = "",  fig.path = "Plot")
library(knitr)
library(dplyr)
library(arm)
library(pROC)
library(tidyverse)
library(MASS)
library(tigerstats)
library(leaps)
library(car)
library(rms)
require(caret)
require(e1071)
library(lme4)
library(lattice)
library(broom)
library(boot)
library(ggplot2)
library(cobalt)
require(tidyverse)
require(rstanarm)
require(magrittr)
require(rstan)
require(MCMCpack)
library(abind)
library(matrixStats)
library(truncnorm)
library(mvtnorm)
library(MCMCpack)
library(mnormt)
library(coda)
library(R.matlab)
mat <- readMat("./2000trials_OneTarget_at_6_80_SingleCellGLR_at80_6.mat")
numerator = mat[['Num.value']]
denominator = mat[['Den.value']]
print('mean numerator')
mean(numerator)
print('mean denominator')
mean(denominator)
num_dof = 2*1 #dimension of the target space
denom_dof = 2*(18144-240) # N-t N - size of sample, t - dimension of clutter space
denom_dof = 2*1998
numerator = numerator*num_dof/mean(numerator) # attempt to scale back y
x_2_sample = rchisq(10000,df=num_dof)
ks.test(x = numerator, y = ecdf(x_2_sample))
print(mean(numerator))
print(mean(x_2_sample))
qqplot(numerator, x_2_sample, ylab = 'X^2(dof = 2)', xlab = 'numerator')
denominator = denominator*denom_dof/mean(denominator) # attempt to scale back y
x_2_sample = rchisq(10000,df=denom_dof)
ks.test(x = denominator, y = ecdf(x_2_sample))
print(mean(denominator))
print(mean(x_2_sample))
qqplot(denominator, x_2_sample, ylab = 'X^2(dof = 2*(N-t))', xlab = 'denominator')
qqplot(denominator[denominator<4000], x_2_sample, ylab = 'X^2(dof = 2*(N-t))', xlab = 'denominator')
